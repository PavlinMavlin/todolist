(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{100:function(t,e,a){},101:function(t,e,a){},130:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),s=a(9),o=a.n(s);a(100),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(101);var c,r,d=a(175),l=a(176),u=a(177),j=a(168),b=a(132),f=a(171),h=a(180),O=a(178),p=a(18),m=a(20),g=a(78),x=a.n(g).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"b5f63428-88b9-4342-8c9b-16d46fb30269"}}),k=function(t){return x.post("/auth/login",t)},v=function(){return x.get("/auth/me")},y=function(){return x.delete("/auth/login")},C=function(){return x.get("todo-lists")},I=function(t){return x.post("todo-lists",{title:t})},T=function(t){return x.delete("todo-lists/".concat(t))},L=function(t,e){return x.put("todo-lists/".concat(t),{title:e})},S=function(t){return x.get("/todo-lists/".concat(t,"/tasks"))},A=function(t,e){return x.post("/todo-lists/".concat(t,"/tasks"),{title:e})},w=function(t,e){return x.delete("/todo-lists/".concat(t,"/tasks/").concat(e))},D=function(t,e,a){return x.put("/todo-lists/".concat(t,"/tasks/").concat(e),a)};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(r||(r={}));var E,F=function(t,e){t(H({error:e})),t(Z({status:"failed"}))},z=function(t,e){t.messages.length?e(H({error:t.messages[0]})):e(H({error:"Some error occurred"})),e(Z({status:"failed"}))},P=a(29),N=Object(P.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),M=N.reducer,R=N.actions.setIsLoggedInAC,U=Object(P.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setIsInitializedAC:function(t,e){t.isInitialized=e.payload.isInitialized},setAppErrorAC:function(t,e){t.error=e.payload.error},setAppStatusAC:function(t,e){t.status=e.payload.status}}}),q=U.reducer,B=U.actions.setIsInitializedAC,H=U.actions.setAppErrorAC,Z=U.actions.setAppStatusAC,J=Object(P.b)({name:"todolists",initialState:[],reducers:{changeTodolistEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].entityStatus=e.payload.entityStatus},removeTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListID}));a>-1&&t.splice(a,1)},addTodoListAC:function(t,e){t.unshift(Object(m.a)(Object(m.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListID}));t[a].title=e.payload.title},changeTodolistFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todoListID}));t[a].filter=e.payload.filter},setTodoAC:function(t,e){return e.payload.todolists.map((function(t){return Object(m.a)(Object(m.a)({},t),{},{filter:"all",entityStatus:"idle"})}))}}}),K=J.actions,W=K.changeTodolistEntityStatusAC,$=K.removeTodoListAC,_=K.addTodoListAC,G=K.changeTodolistTitleAC,V=K.changeTodolistFilterAC,Y=K.setTodoAC,Q=J.reducer,X=Object(P.b)({name:"tasks",initialState:{},reducers:{changeTaskEntityStatusAC:function(t,e){},updateTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(m.a)(Object(m.a)({},a[n]),e.payload.model))},removeTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskID}));n>-1&&a.splice(n,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(Object(m.a)(Object(m.a)({},e.payload.task),{},{entityStatus:"idle"}))},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks.map((function(t){return Object(m.a)(Object(m.a)({},t),{},{entityStatus:"idle"})}))}},extraReducers:function(t){t.addCase(_,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase($,(function(t,e){delete t[e.payload.todoListID]})),t.addCase(Y,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))}))}}),tt=X.actions,et=tt.changeTaskEntityStatusAC,at=tt.updateTaskAC,nt=tt.removeTaskAC,it=tt.addTaskAC,st=tt.setTasksAC,ot=X.reducer;!function(t){t[t.success=0]="success",t[t.error=1]="error",t[t.captcha=10]="captcha"}(E||(E={}));var ct=function(t,e,a){return function(n,i){var s=i().tasks[a].find((function(e){return e.id===t}));if(s){var o=Object(m.a)({deadline:s.deadline,description:s.description,priority:s.priority,startDate:s.startDate,title:s.title,status:s.status},e);n(Z({status:"loading"})),n(et({taskID:t,todolistId:a,entityStatus:"loading"})),D(a,t,o).then((function(i){if(0===i.data.resultCode){var s=at({taskId:t,model:e,todolistId:a});n(s),n(Z({status:"succeeded"})),n(et({taskID:t,todolistId:a,entityStatus:"succeeded"}))}else z(i.data,n)})).catch((function(t){F(n,t.message)}))}else console.warn("task not found in the state")}},rt=a(172),dt=a(131),lt=a(38),ut=a(169),jt=a(181),bt=a(3),ft=i.a.memo((function(t){var e=Object(n.useState)(""),a=Object(lt.a)(e,2),i=a[0],s=a[1],o=Object(n.useState)(null),c=Object(lt.a)(o,2),r=c[0],d=c[1],l=function(){""!==i.trim()?(t.addItem(i),s("")):d("Title is required")};return Object(bt.jsxs)("div",{children:[Object(bt.jsx)(jt.a,{variant:"outlined",value:i,onChange:function(t){s(t.currentTarget.value)},onKeyPress:function(t){null!==r&&d(null),"Enter"===t.key&&l()},helperText:r,label:"Title",error:!!r,disabled:t.disabled}),Object(bt.jsx)(j.a,{color:"primary",onClick:l,disabled:t.disabled,children:Object(bt.jsx)(ut.a,{})})]})})),ht=i.a.memo((function(t){var e=Object(n.useState)(!1),a=Object(lt.a)(e,2),i=a[0],s=a[1],o=Object(n.useState)(t.title),c=Object(lt.a)(o,2),r=c[0],d=c[1];return i?Object(bt.jsx)(jt.a,{color:"primary",variant:"standard",value:r,onChange:function(t){d(t.currentTarget.value)},autoFocus:!0,onBlur:function(){s(!1),t.changeTitle(r)},disabled:t.disabled}):Object(bt.jsx)("span",{onDoubleClick:function(){return s(!0)},children:t.title})})),Ot=a(170),pt=a(183),mt=i.a.memo((function(t){var e=t.entityStatus,a=t.task,i=t.todoListID,s=t.removeTask,o=t.changeTaskTitle,r=t.changeTaskStatus;console.log(e);var d=Object(n.useCallback)((function(){s(a.id,i)}),[s,a,i]),l=Object(n.useCallback)((function(t){return r(a.id,t.currentTarget.checked?c.Completed:c.New,i)}),[r,a,i]),u=Object(n.useCallback)((function(t){return o(a.id,t,i)}),[o,a,i]);return Object(bt.jsxs)("div",{children:[Object(bt.jsxs)("span",{className:a.status===c.Completed?"is-done":"",children:[Object(bt.jsx)(pt.a,{color:"primary",checked:a.status===c.Completed,onChange:l,disabled:"loading"===e}),Object(bt.jsx)(ht,{title:a.title,changeTitle:u,disabled:"loading"===e})]}),Object(bt.jsx)(j.a,{disabled:"loading"===e,onClick:d,children:Object(bt.jsx)(Ot.a,{})})]},a.id)})),gt=i.a.memo((function(t){var e=Object(p.b)();Object(n.useEffect)((function(){var a;e((a=t.todoListID,function(t){t(Z({status:"loading"})),S(a).then((function(e){var n=e.data.items;t(st({todolistId:a,tasks:n})),t(Z({status:"succeeded"}))})).catch((function(e){t(H({error:e.message})),t(Z({status:"failed"}))}))}))}),[]);var a=function(){switch(t.filter){case"active":return t.tasks.filter((function(t){return t.status===c.New}));case"completed":return t.tasks.filter((function(t){return t.status===c.Completed}));default:return t.tasks}}().map((function(e){return Object(bt.jsx)(mt,{task:e,todoListID:t.todoListID,changeTaskStatus:t.changeTaskStatus,changeTaskTitle:t.changeTaskTitle,removeTask:t.removeTask,entityStatus:e.entityStatus},e.id)})),i=Object(n.useCallback)((function(){return t.changeFilter("all",t.todoListID)}),[t.changeFilter,t.todoListID]),s=Object(n.useCallback)((function(){return t.changeFilter("active",t.todoListID)}),[t.changeFilter,t.todoListID]),o=Object(n.useCallback)((function(){return t.changeFilter("completed",t.todoListID)}),[t.changeFilter,t.todoListID]),r=Object(n.useCallback)((function(e){t.addTask(e,t.todoListID)}),[t.addTask,t.todoListID]),d=Object(n.useCallback)((function(e){return t.changeTodolistTitle(e,t.todoListID)}),[t.changeTodolistTitle,t.todoListID]);return Object(bt.jsxs)("div",{children:[Object(bt.jsxs)("h3",{children:[Object(bt.jsx)(ht,{title:t.title,changeTitle:d,disabled:"loading"===t.entityStatus}),Object(bt.jsx)(j.a,{onClick:function(){return t.removeTodoList(t.todoListID)},disabled:"loading"===t.entityStatus,children:Object(bt.jsx)(Ot.a,{})})]}),Object(bt.jsx)(ft,{addItem:r,disabled:"loading"===t.entityStatus}),Object(bt.jsx)("ul",{style:{listStyle:"none",paddingLeft:"0px"},children:a}),Object(bt.jsxs)("div",{children:[Object(bt.jsx)(f.a,{size:"small",variant:"all"===t.filter?"contained":"outlined",color:"primary",onClick:i,children:"All"}),Object(bt.jsx)(f.a,{style:{marginLeft:"3px"},size:"small",variant:"active"===t.filter?"contained":"outlined",color:"primary",onClick:s,children:"Active"}),Object(bt.jsx)(f.a,{size:"small",variant:"completed"===t.filter?"contained":"outlined",color:"primary",onClick:o,children:"Completed"})]})]})})),xt=a(14),kt=function(){var t=Object(p.c)((function(t){return t.todolists})),e=Object(p.c)((function(t){return t.tasks})),a=Object(p.b)(),i=Object(p.c)((function(t){return t.auth.isLoggedIn}));Object(n.useEffect)((function(){i&&a((function(t){t(Z({status:"loading"})),C().then((function(e){var a=e.data;t(Y({todolists:a})),t(Z({status:"succeeded"}))})).catch((function(e){t(H({error:e.message})),t(Z({status:"failed"}))}))}))}),[]),console.log(e);var s=Object(n.useCallback)((function(t,e,n){a(ct(t,{title:e},n))}),[a]),o=Object(n.useCallback)((function(t,e){a(function(t,e){return function(a){a(Z({status:"loading"})),A(e,t).then((function(t){if(t.data.resultCode===E.success){var e=t.data.data.item;a(it({task:e})),a(Z({status:"succeeded"}))}else z(t.data,a)})).catch((function(t){F(a,t.message)}))}}(t,e))}),[a]),c=Object(n.useCallback)((function(t,e,n){a(ct(t,{status:e},n))}),[a]),r=Object(n.useCallback)((function(t,e){a(function(t,e){return function(a){a(Z({status:"loading"})),a(et({taskID:t,todolistId:e,entityStatus:"loading"})),w(e,t).then((function(n){a(nt({taskID:t,todolistId:e})),a(Z({status:"succeeded"})),a(et({taskID:t,todolistId:e,entityStatus:"succeeded"}))})).catch((function(t){a(H({error:t.message})),a(Z({status:"failed"}))}))}}(t,e))}),[a]),d=Object(n.useCallback)((function(t,e){a(V({filter:t,todoListID:e}))}),[a]),l=Object(n.useCallback)((function(t){var e,n=(e=t,function(t){t(Z({status:"loading"})),t(W({id:e,entityStatus:"loading"})),T(e).then((function(){t($({todoListID:e})),t(Z({status:"succeeded"}))})).catch((function(e){t(H({error:e.message})),t(Z({status:"failed"}))}))});a(n)}),[a]),u=Object(n.useCallback)((function(t){var e=function(t){return function(e){e(Z({status:"loading"})),I(t).then((function(t){0==t.data.resultCode?(e(_({todolist:t.data.data.item})),e(Z({status:"succeeded"}))):(t.data.messages.length?e(H({error:t.data.messages[0]})):e(H({error:"Some error occurred"})),e(Z({status:"failed"})))}))}}(t);a(e)}),[a]),j=Object(n.useCallback)((function(t,e){a(function(t,e){return function(a){a(Z({status:"loading"})),L(e,t).then((function(){a(G({title:t,todoListID:e})),a(Z({status:"succeeded"}))})).catch((function(t){a(H({error:t.message})),a(Z({status:"failed"}))}))}}(t,e))}),[a]),b=t.map((function(t){return Object(bt.jsx)(rt.a,{item:!0,children:Object(bt.jsx)(dt.a,{elevation:5,style:{padding:"20px"},children:Object(bt.jsx)(gt,{entityStatus:t.entityStatus,todoListID:t.id,removeTask:r,filter:t.filter,tasks:e[t.id],title:t.title,changeFilter:d,addTask:o,changeTaskStatus:c,removeTodoList:l,changeTaskTitle:s,changeTodolistTitle:j})})},t.id)}));return i?Object(bt.jsxs)(bt.Fragment,{children:[Object(bt.jsx)(rt.a,{container:!0,style:{padding:"20px 0px"},children:Object(bt.jsx)(ft,{addItem:u})}),Object(bt.jsx)(rt.a,{container:!0,spacing:3,children:b})]}):Object(bt.jsx)(xt.a,{to:"/login"})},vt=a(179),yt=a(185),Ct=a(182);function It(t){return Object(bt.jsx)(Ct.a,Object(m.a)({elevation:6,variant:"filled"},t))}function Tt(){var t=Object(p.c)((function(t){return t.app.error})),e=Object(p.b)(),a=i.a.useState(!0),n=Object(lt.a)(a,2),s=(n[0],n[1]),o=function(t,a){"clickaway"!==a&&(s(!1),e(H({error:null})))};return Object(bt.jsx)(yt.a,{open:null!==t,autoHideDuration:6e3,onClose:o,children:Object(bt.jsx)(It,{onClose:o,severity:"error",children:t})})}var Lt=a(186),St=a(167),At=a(173),wt=a(174),Dt=a(85),Et=function(){var t=Object(p.b)(),e=Object(p.c)((function(t){return t.auth.isLoggedIn})),a=Object(Dt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<4&&(e.password="Must be more than 4 characters"):e.password="Required",e},onSubmit:function(e){var n;t((n=e,function(t){t(Z({status:"loading"})),k(n).then((function(e){0===e.data.resultCode?(t(R({value:!0})),t(Z({status:"succeeded"}))):z(e.data,t)})).catch((function(e){F(t,e.message)}))})),a.resetForm()}});return e?Object(bt.jsx)(xt.a,{to:"/"}):Object(bt.jsx)(rt.a,{container:!0,justify:"center",children:Object(bt.jsx)(rt.a,{item:!0,xs:4,children:Object(bt.jsx)("form",{onSubmit:a.handleSubmit,children:Object(bt.jsxs)(Lt.a,{children:[Object(bt.jsxs)(St.a,{children:[Object(bt.jsxs)("p",{children:["To log in get registered",Object(bt.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:"here"})]}),Object(bt.jsx)("p",{children:"or use common test account credentials:"}),Object(bt.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(bt.jsx)("p",{children:"Password: free"})]}),Object(bt.jsxs)(At.a,{children:[Object(bt.jsx)(jt.a,Object(m.a)({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.errors.email&&a.touched.email&&Object(bt.jsx)("div",{style:{color:"red"},children:a.errors.email}),Object(bt.jsx)(jt.a,Object(m.a)({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.touched.email&&a.errors.password&&Object(bt.jsx)("div",{style:{color:"red"},children:a.errors.password}),Object(bt.jsx)(wt.a,{label:"Remember me",control:Object(bt.jsx)(pt.a,{name:"rememberMe",onChange:a.handleChange,value:a.values.rememberMe})}),Object(bt.jsx)(f.a,{type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})})})};var Ft=function(){var t=Object(p.c)((function(t){return t.app.status})),e=Object(p.b)(),a=Object(p.c)((function(t){return t.app.isInitialized})),i=Object(p.c)((function(t){return t.auth.isLoggedIn}));return Object(n.useEffect)((function(){e((function(t){v().then((function(e){0===e.data.resultCode&&(t(R({value:!0})),t(B({isInitialized:!0})))})).finally((function(){t(B({isInitialized:!0}))}))}))}),[]),a?Object(bt.jsxs)("div",{className:"App",children:[Object(bt.jsx)(Tt,{}),Object(bt.jsxs)(l.a,{position:"static",children:[Object(bt.jsxs)(u.a,{style:{justifyContent:"space-between"},children:[Object(bt.jsx)(j.a,{color:"inherit",children:Object(bt.jsx)(O.a,{})}),Object(bt.jsx)(b.a,{variant:"h6",children:"Todolists"}),i&&Object(bt.jsx)(f.a,{variant:"outlined",onClick:function(){e((function(t){t(Z({status:"loading"})),y().then((function(e){0===e.data.resultCode?(t(R({value:!1})),t(Z({status:"succeeded"}))):z(e.data,t)})).catch((function(e){F(t,e)}))}))},color:"inherit",children:"Log out"})]}),"loading"===t&&Object(bt.jsx)(vt.a,{color:"secondary"})]}),Object(bt.jsx)(h.a,{fixed:!0,children:Object(bt.jsxs)(xt.d,{children:[Object(bt.jsx)(xt.b,{exact:!0,path:"/",render:function(){return Object(bt.jsx)(kt,{})}}),Object(bt.jsx)(xt.b,{path:"/login",render:function(){return Object(bt.jsx)(Et,{})}}),Object(bt.jsx)(xt.b,{path:"/404",render:function(){return Object(bt.jsx)("h1",{children:"404: PAGE NOT FOUND"})}}),Object(bt.jsx)(xt.a,{from:"*",to:"/404"})]})})]}):Object(bt.jsx)("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"},children:Object(bt.jsx)(d.a,{})})},zt=a(26),Pt=a(47),Nt=Object(zt.b)({tasks:ot,todolists:Q,app:q,auth:M}),Mt=Object(P.a)({reducer:Nt,middleware:function(t){return t().prepend(Pt.a)}});window.store=Mt;var Rt=a(46);o.a.render(Object(bt.jsx)(p.a,{store:Mt,children:Object(bt.jsx)(Rt.a,{children:Object(bt.jsx)(Ft,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[130,1,2]]]);
//# sourceMappingURL=main.3ef5dcf1.chunk.js.map